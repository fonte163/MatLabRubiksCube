\documentclass[a4paper,12pt]{scrartcl}

\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{listings}
\usepackage[dvipsnames]{xcolor}

\usepackage[headsepline]{scrlayer-scrpage}
\pagestyle{scrheadings}
\clearscrheadfoot
\ohead{Elisa Junghans\\Mirko Dransfeld}
\ihead{Wissenschaftliches Rechnen\\SS 19}
\chead{Praktikum MatLab\\Rubik's Cube}
\cfoot*{\pagemark}

\title{Rubik's Cube}
\subtitle{MatLab Praktikum}
\author{Elisa Junghans\and Mirko Dransfeld}
\date{}

\usepackage[bookmarks]{hyperref}


\hypersetup{
    unicode=true,
    colorlinks=true,
    linkcolor=black,
    linktoc=all,
    citecolor=black,
    filecolor=black,
    urlcolor=black,
    final=true
}
\lstset{ %
      basicstyle=\small\ttfamily,
      language=Matlab,
      showtabs=false,
      tabsize=2,
      captionpos=t,
      breaklines=true,
      extendedchars=true,
      showstringspaces=false,
      flexiblecolumns=true,
      numbers=left,
      numbersep=.5em,
      stepnumber=1,
      numberstyle=\color{Gray},
      keywordstyle=\color{Blue},
      commentstyle=\color{ForestGreen}
}
\newcommand{\mcode}[3]{
  \lstinputlisting[firstnumber=#1, linerange={#1-#2}]{#3.m}
}

\begin{document}
  \maketitle
  \mcode{84}{104}{RubiksCube}
\end{document}
